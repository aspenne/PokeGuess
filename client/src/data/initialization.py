import json

# Charger les données JSON depuis un fichier
with open('./pokemons_data.json', 'r') as json_file:
    pokemon_data = json.load(json_file)

with open('./pokemons_script.sql', 'w') as pokemon_file:
    pokemon_file.write("-- Insert Into Pokemons Table\n")
    pokemon_file.write("INSERT INTO PokeGuess.Pokemon (pokedexId, generation, category, name_fr, name_en, type_1, type_2, talent_1, talent_2, talent_3, hp, atk, def, spe_atk, spe_def, vit, height, weight, stade) VALUES\n")
    for pokemon in pokemon_data:
        weight = pokemon['weight'].replace(",", ".").replace(' kg', '')
        height = pokemon['height'].replace(",", ".").replace('m', '')
        category = pokemon['category'].replace("'", "''")
        talents = pokemon['talents']
        types = pokemon['types']

        if len(types) == 2:
            pokemon_file.write(f"\t({pokemon['pokedexId']}, {pokemon['generation']}, \"{category}\", \"{pokemon['name']['fr']}\", \"{pokemon['name']['en']}\", \"{pokemon['types'][0]['name']}\", \"{pokemon['types'][1]['name']}\", ")
        else:
            pokemon_file.write(f"\t({pokemon['pokedexId']}, {pokemon['generation']}, \"{category}\", \"{pokemon['name']['fr']}\", \"{pokemon['name']['en']}\", \"{pokemon['types'][0]['name']}\", null, ")


        if len(talents) == 3:
            pokemon_file.write(f"\"{talents[0]['name']}\", \"{talents[1]['name']}\", \"{talents[2]['name']}\", ")
        elif len(talents) == 2:
            pokemon_file.write(f"\"{talents[0]['name']}\", \"{talents[1]['name']}\", null, ")
        else:
            pokemon_file.write(f"\"{talents[0]['name']}\", null, null, ")
        
        pokemon_file.write(f"{pokemon['stats']['hp']}, {pokemon['stats']['atk']}, {pokemon['stats']['def']}, {pokemon['stats']['spe_atk']}, {pokemon['stats']['spe_def']}, {pokemon['stats']['vit']}, {height}, {weight}, {pokemon['stade']}),\n")


with open('./pokemons_script.sql', 'r') as pokemon_file:
    content = pokemon_file.read()

# Replace types name with correspondings IDs
content = content.replace("\"Plante\"", "1")
content = content.replace("\"Poison\"", "2")
content = content.replace("\"Feu\"", "3")
content = content.replace("\"Vol\"", "4")
content = content.replace("\"Glace\"", "5")
content = content.replace("\"Eau\"", "6")
content = content.replace("\"Insecte\"", "7")
content = content.replace("\"Tenebres\"", "8")
content = content.replace("\"Normal\"", "9")
content = content.replace("\"Electrik\"", "10")
content = content.replace("\"Sol\"", "11")
content = content.replace("\"Fee\"", "12")
content = content.replace("\"Combat\"", "13")
content = content.replace("\"Psy\"", "14")
content = content.replace("\"Roche\"", "15")
content = content.replace("\"Acier\"", "16")
content = content.replace("\"Spectre\"", "17")
content = content.replace("\"Dragon\"", "18")


# Replace talent names with corresponding IDs
content = content.replace("\"Engrais\"", "1")
content = content.replace("\"Chlorophylle\"", "2")
content = content.replace("\"Brasier\"", "3")
content = content.replace("\"Force Soleil\"", "4")
content = content.replace("\"Torrent\"", "5")
content = content.replace("\"Cuvette\"", "6")
content = content.replace("\"Ecran Poudre\"", "7")
content = content.replace("\"Fuite\"", "8")
content = content.replace("\"Mue\"", "9")
content = content.replace("\"Œil Compose\"", "10")
content = content.replace("\"Lentiteintee\"", "11")
content = content.replace("\"Essaim\"", "12")
content = content.replace("\"Sniper\"", "13")
content = content.replace("\"Regard Vif\"", "14")
content = content.replace("\"Pieds Confus\"", "15")
content = content.replace("\"Cœur de Coq\"", "16")
content = content.replace("\"Cran\"", "17")
content = content.replace("\"Agitation\"", "18")
content = content.replace("\"Intimidation\"", "19")
content = content.replace("\"Tension\"", "20")
content = content.replace("\"Statik\"", "21")
content = content.replace("\"Paratonnerre\"", "22")
content = content.replace("\"Voile Sable\"", "23")
content = content.replace("\"Baigne Sable\"", "24")
content = content.replace("\"Point Poison\"", "25")
content = content.replace("\"Rivalite\"", "26")
content = content.replace("\"Sans Limite\"", "27")
content = content.replace("\"Joli Sourire\"", "28")
content = content.replace("\"Garde Magik\"", "29")
content = content.replace("\"Garde-Ami\"", "30")
content = content.replace("\"Inconscient\"", "31")
content = content.replace("\"Torche\"", "32")
content = content.replace("\"Secheresse\"", "33")
content = content.replace("\"Battant\"", "34")
content = content.replace("\"Fouille\"", "35")
content = content.replace("\"Attention\"", "36")
content = content.replace("\"Infiltration\"", "37")
content = content.replace("\"Puanteur\"", "38")
content = content.replace("\"Pose Spore\"", "39")
content = content.replace("\"Peau Seche\"", "40")
content = content.replace("\"Moiteur\"", "41")
content = content.replace("\"Peau Miracle\"", "42")
content = content.replace("\"Piege Sable\"", "43")
content = content.replace("\"Force Sable\"", "44")
content = content.replace("\"Ramassage\"", "45")
content = content.replace("\"Technicien\"", "46")
content = content.replace("\"Echauffement\"", "47")
content = content.replace("\"Ciel Gris\"", "48")
content = content.replace("\"Glissade\"", "49")
content = content.replace("\"Esprit Vital\"", "50")
content = content.replace("\"Colerique\"", "51")
content = content.replace("\"Acharne\"", "52")
content = content.replace("\"Cœur Noble\"", "53")
content = content.replace("\"Absorbe-Eau\"", "54")
content = content.replace("\"Synchro\"", "55")
content = content.replace("\"Annule Garde\"", "56")
content = content.replace("\"Impassible\"", "57")
content = content.replace("\"Gloutonnerie\"", "58")
content = content.replace("\"Corps Sain\"", "59")
content = content.replace("\"Suintement\"", "60")
content = content.replace("\"Tête de Roc\"", "61")
content = content.replace("\"Fermete\"", "62")
content = content.replace("\"Corps Ardent\"", "63")
content = content.replace("\"Benêt\"", "64")
content = content.replace("\"Tempo Perso\"", "65")
content = content.replace("\"Rege-Force\"", "66")
content = content.replace("\"Magnepiege\"", "67")
content = content.replace("\"Analyste\"", "68")
content = content.replace("\"Matinal\"", "69")
content = content.replace("\"Isograisse\"", "70")
content = content.replace("\"Hydratation\"", "71")
content = content.replace("\"Corps Gel\"", "72")
content = content.replace("\"Glu\"", "73")
content = content.replace("\"Toxitouche\"", "74")
content = content.replace("\"Coque Armure\"", "75")
content = content.replace("\"Multi-Coups\"", "76")
content = content.replace("\"Envelocape\"", "77")
content = content.replace("\"Levitation\"", "78")
content = content.replace("\"Corps Maudit\"", "79")
content = content.replace("\"Armurouillee\"", "80")
content = content.replace("\"Insomnia\"", "81")
content = content.replace("\"Prediction\"", "82")
content = content.replace("\"Hyper Cutter\"", "83")
content = content.replace("\"Anti-Bruit\"", "84")
content = content.replace("\"Boom Final\"", "85")
content = content.replace("\"Recolte\"", "86")
content = content.replace("\"Armurbaston\"", "87")
content = content.replace("\"Temeraire\"", "88")
content = content.replace("\"Delestage\"", "89")
content = content.replace("\"Poing de Fer\"", "90")
content = content.replace("\"Gaz Inhibiteur\"", "91")
content = content.replace("\"Medic Nature\"", "92")
content = content.replace("\"Serenite\"", "93")
content = content.replace("\"Cœur Soin\"", "94")
content = content.replace("\"Feuille Garde\"", "95")
content = content.replace("\"Querelleur\"", "96")
content = content.replace("\"Ignifu-Voile\"", "97")
content = content.replace("\"Lumiattirance\"", "98")
content = content.replace("\"Filtre\"", "99")
content = content.replace("\"Brise Moule\"", "100")
content = content.replace("\"Impudence\"", "101")
content = content.replace("\"Phobique\"", "102")
content = content.replace("\"Imposteur\"", "103")
content = content.replace("\"Adaptabilite\"", "104")
content = content.replace("\"Anticipation\"", "105")
content = content.replace("\"Absorbe-Volt\"", "106")
content = content.replace("\"Pied Veloce\"", "107")
content = content.replace("\"Calque\"", "108")
content = content.replace("\"Telecharge\"", "109")
content = content.replace("\"Pression\"", "110")
content = content.replace("\"Vaccin\"", "111")
content = content.replace("\"Rideau Neige\"", "112")
content = content.replace("\"Ecaille Speciale\"", "113")
content = content.replace("\"Multiecaille\"", "114")
content = content.replace("\"Chanceux\"", "115")
content = content.replace("\"Miroir Magik\"", "116")
content = content.replace("\"Plus\"", "117")
content = content.replace("\"Coloforce\"", "118")
content = content.replace("\"Herbivore\"", "119")
content = content.replace("\"Crachin\"", "120")
content = content.replace("\"Turbo\"", "121")
content = content.replace("\"Farceur\"", "122")
content = content.replace("\"Marque Ombre\"", "123")
content = content.replace("\"Telepathe\"", "124")
content = content.replace("\"Light Metal\"", "125")
content = content.replace("\"Contestation\"", "126")
content = content.replace("\"Pickpocket\"", "127")
content = content.replace("\"Cherche Miel\"", "128")
content = content.replace("\"Armumagma\"", "129")
content = content.replace("\"Lunatique\"", "130")
content = content.replace("\"Ventouse\"", "131")
content = content.replace("\"Sable Volant\"", "132")
content = content.replace("\"Soin Poison\"", "133")
content = content.replace("\"Absenteisme\"", "134")
content = content.replace("\"Garde Mystik\"", "135")
content = content.replace("\"Normalise\"", "136")
content = content.replace("\"Frein\"", "137")
content = content.replace("\"Heavy Metal\"", "138")
content = content.replace("\"Force Pure\"", "139")
content = content.replace("\"Moins\"", "140")
content = content.replace("\"Peau Dure\"", "141")
content = content.replace("\"Simple\"", "142")
content = content.replace("\"Solide Roc\"", "143")
content = content.replace("\"Ecran Fumee\"", "144")
content = content.replace("\"Rage Poison\"", "145")
content = content.replace("\"Lavabo\"", "146")
content = content.replace("\"Meteo\"", "147")
content = content.replace("\"Homochromie\"", "148")
content = content.replace("\"Proteen\"", "149")
content = content.replace("\"Air Lock\"", "150")
content = content.replace("\"Don Floral\"", "151")
content = content.replace("\"Rage Brûlure\"", "152")
content = content.replace("\"Maladresse\"", "153")
content = content.replace("\"Ignifuge\"", "154")
content = content.replace("\"Alerte Neige\"", "155")
content = content.replace("\"Motorise\"", "156")
content = content.replace("\"Incisif\"", "157")
content = content.replace("\"Debut Calme\"", "158")
content = content.replace("\"Mauvais Rêve\"", "159")
content = content.replace("\"Multitype\"", "160")
content = content.replace("\"Victorieux\"", "161")
content = content.replace("\"Mode Transe\"", "162")
content = content.replace("\"Momie\"", "163")
content = content.replace("\"Defaitiste\"", "164")
content = content.replace("\"Illusion\"", "165")
content = content.replace("\"Epine de Fer\"", "166")
content = content.replace("\"Chasse-Neige\"", "167")
content = content.replace("\"Turbo Brasier\"", "168")
content = content.replace("\"Tera-Voltage\"", "169")
content = content.replace("\"Pare-Balles\"", "170")
content = content.replace("\"Magicien\"", "171")
content = content.replace("\"Synergie\"", "172")
content = content.replace("\"Bajoues\"", "173")
content = content.replace("\"Ailes Bourrasque\"", "174")
content = content.replace("\"Oeil Compose\"", "175")
content = content.replace("\"Flora-Voile\"", "176")
content = content.replace("\"Symbiose\"", "177")
content = content.replace("\"Toison Herbue\"", "178")
content = content.replace("\"Toison Epaisse\"", "179")
content = content.replace("\"Declic Tactique\"", "180")
content = content.replace("\"Aroma-Voile\"", "181")
content = content.replace("\"Gluco-Voile\"", "182")
content = content.replace("\"Griffe Dure\"", "183")
content = content.replace("\"Mega Blaster\"", "184")
content = content.replace("\"Prognathe\"", "185")
content = content.replace("\"Peau Gelee\"", "186")
content = content.replace("\"Peau Feerique\"", "187")
content = content.replace("\"Poisseux\"", "188")
content = content.replace("\"Aura Feerique\"", "189")
content = content.replace("\"Aura Tenebreuse\"", "190")
content = content.replace("\"Aura Inversee\"", "191")
content = content.replace("\"Rassemblement\"", "192")
content = content.replace("\"Longue Portee\"", "193")
content = content.replace("\"Hydrata-Son\"", "194")
content = content.replace("\"Filature\"", "195")
content = content.replace("\"Batterie\"", "196")
content = content.replace("\"Danseuse\"", "197")
content = content.replace("\"Banc\"", "198")
content = content.replace("\"Cruaute\"", "199")
content = content.replace("\"Endurance\"", "200")
content = content.replace("\"Aquabulle\"", "201")
content = content.replace("\"Corrosion\"", "202")
content = content.replace("\"Boule de Poils\"", "203")
content = content.replace("\"Prestance Royale\"", "204")
content = content.replace("\"Prioguerison\"", "205")
content = content.replace("\"Receveur\"", "206")
content = content.replace("\"Escampette\"", "207")
content = content.replace("\"Repli Tactique\"", "208")
content = content.replace("\"Sable Humide\"", "209")
content = content.replace("\"Expuls'Organes\"", "210")
content = content.replace("\"Systeme Alpha\"", "211")
content = content.replace("\"Bouclier-Carcan\"", "212")
content = content.replace("\"Hypersommeil\"", "213")
content = content.replace("\"Fantômasque\"", "214")
content = content.replace("\"Corps Colore\"", "215")
content = content.replace("\"Dracolere\"", "216")
content = content.replace("\"Expert Acier\"", "217")
content = content.replace("\"Crea-Elec\"", "218")
content = content.replace("\"Crea-Psy\"", "219")
content = content.replace("\"Crea-Herbe\"", "220")
content = content.replace("\"Crea-Brume\"", "221")
content = content.replace("\"Metallo-Garde\"", "222")
content = content.replace("\"Spectro-Bouclier\"", "223")
content = content.replace("\"Boost Chimere\"", "224")
content = content.replace("\"Prisme-Armure\"", "225")
content = content.replace("\"Animacœur\"", "226")
content = content.replace("\"Libero\"", "227")
content = content.replace("\"Effilochage\"", "228")
content = content.replace("\"Ramasse Ball\"", "229")
content = content.replace("\"Turbine\"", "230")
content = content.replace("\"Mûrissement\"", "231")
content = content.replace("\"Expul'Sable\"", "232")
content = content.replace("\"Debogage\"", "233")
content = content.replace("\"Propulseur\"", "234")
content = content.replace("\"Punk Rock\"", "235")
content = content.replace("\"Plus/Moins\"", "236")
content = content.replace("\"Boost Acier\"", "237")
content = content.replace("\"Corps Condamne\"", "238")
content = content.replace("\"Brise-Arriere\"", "239")
content = content.replace("\"Ame Vagabonde\"", "240")
content = content.replace("\"Ecailles Glacees\"", "241")
content = content.replace("\"Cercle d'Energie\"", "242")
content = content.replace("\"Tête de Gel\"", "243")
content = content.replace("\"Declic Fringale\"", "244")
content = content.replace("\"Nerfs d'Acier\"", "245")
content = content.replace("\"Lame Indomptable\"", "246")
content = content.replace("\"Egide Inflexible\"", "247")
content = content.replace("\"Point Invisible\"", "248")
content = content.replace("\"Transistor\"", "249")
content = content.replace("\"Dent de Dragon\"", "250")
content = content.replace("\"Blanche Ruade\"", "251")
content = content.replace("\"Sombre Ruade\"", "252")
content = content.replace("\"Adaptabilité\"", "253")
content = content.replace("\"Odeur Tenace (Male) / Aroma-Voile (Femelle)\"", "254")
content = content.replace("\"Bien Cuit\"", "255")
content = content.replace("\"Semencier\"", "256")
content = content.replace("\"Sans Limite/Cran\"", "257")
content = content.replace("\"Sel Purificateur\"", "258")
content = content.replace("\"Grecharge\"", "259")
content = content.replace("\"Turbine Eolienne\"", "260")
content = content.replace("\"Chien de Garde\"", "261")
content = content.replace("\"Aeroporte\"", "262")
content = content.replace("\"Force Fongique\"", "263")
content = content.replace("\"Courroupace\"", "264")
content = content.replace("\"Opportuniste\"", "265")
content = content.replace("\"Porte-Roche\"", "266")
content = content.replace("\"Supermutation\"", "267")
content = content.replace("\"Absorbe-Terre\"", "268")
content = content.replace("\"Depôt Toxique\"", "269")
content = content.replace("\"Collab\"", "270")
content = content.replace("\"Commandant\"", "271")
content = content.replace("\"Ruminant\"", "272")
content = content.replace("\"Armure Caudale\"", "273")
content = content.replace("\"General Suprême\"", "274")
content = content.replace("\"Paleosynthese\"", "275")
content = content.replace("\"Charge Quantique\"", "276")
content = content.replace("\"Thermodynamique\"", "277")
content = content.replace("\"Corps en Or\"", "278")
content = content.replace("\"Bois du Fleau\"", "279")
content = content.replace("\"Epee du Fleau\"", "280")
content = content.replace("\"Pouls Orichalque\"", "281")
content = content.replace("\"Moteur à Hadrons\"", "282")


with open('./pokemons_script.sql', 'w') as pokemon_file:
    pokemon_file.write(content)

# add in Type Table 
with open('./pokemons_script.sql', 'a') as pokemon_file:
    pokemon_file.write("\n\n-- Insert Into Types Table\n")
    pokemon_file.write("INSERT INTO PokeGuess.Types (type_id, type_name) VALUES\n")
    pokemon_file.write('\t(1, "Plante"),\n' '\t(2, "Poison"),\n' '\t(3, "Feu"),\n' '\t(4, "Vol"),\n'
	                    '\t(5, "Glace"),\n' '\t(6, "Eau"),\n' '\t(7, "Insecte"),\n' '\t(8, "Ténèbres"),\n'
	                    '\t(9, "Normal"),\n' '\t(10, "Electrik"),\n' '\t(11, "Sol"),\n' '\t(12, "Fee"),\n'
	                    '\t(13, "Combat"),\n' '\t(14, "Psy"),\n' '\t(15, "Roche"),\n' '\t(16, "Acier"),\n'
	                    '\t(17, "Spectre"),\n' '\t(18, "Dragon");\n')


# add in Talents Table
with open('./pokemons_script.sql', 'a') as pokemon_file:
    pokemon_file.write("\n\n-- Insert Into Talents Table\n")
    pokemon_file.write("INSERT INTO PokeGuess.Talents (talent_id, talent_name) VALUES\n")
    inserted_talents = set()
    talent_id = 1
    for pokemon in pokemon_data:
        if pokemon['talents'] is not None:
            for talent in pokemon['talents']:
                talent_name = talent['name']
                if talent_name not in inserted_talents:
                    inserted_talents.add(talent_name)  
                    pokemon_file.write(f"\t({talent_id}, \"{talent_name}\"),\n")
                    talent_id = talent_id + 1


# add in Evolution Table
with open('./pokemons_script.sql', 'a') as pokemon_file:
    pokemon_file.write("\n\n-- Insert Into Evolutions Table\n")
    pokemon_file.write("INSERT INTO PokeGuess.Evolutions (pokedexId, pre_pokedexId, next_pokedexId, Mega_evolution, condition_evolution) VALUES\n")
    for pokemon in pokemon_data:
        if pokemon['evolution'] != None:
            if pokemon['evolution']['pre'] != None:
                for i in range (len(pokemon['evolution']['pre'])):
                    pokemon_file.write(f"\t({pokemon['pokedexId']}, {pokemon['evolution']['pre'][i]['pokedexId']}, null, false, null),\n")
            if pokemon['evolution']['next'] != None:
                for i in range (len(pokemon['evolution']['next'])):
                    pokemon_file.write(f"\t({pokemon['pokedexId']}, null, {pokemon['evolution']['next'][i]['pokedexId']}, false, \"{pokemon['evolution']['next'][i]['condition']}\"),\n")
            if pokemon['evolution']['mega'] != None:
                for i in range (len(pokemon['evolution']['mega'])):
                    pokemon_file.write(f"\t({pokemon['pokedexId']}, null, null, true, null),\n")